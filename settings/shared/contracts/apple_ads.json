{
  "apiVersion": "v3.1.0",
  "kind": "DataContract",
  "id": "apple_ads",
  "name": "Apple Search Ads Report",
  "version": "1.0.0",
  "status": "active",
  "domain": "advertising",
  "description": "Raw performance data from Apple Search Ads API reports (campaign_report, keyword_report, search_term_report, etc.). Contains campaign, ad group, keyword, and search term-level metrics for iOS UA campaigns. One row per date + level + breakdown combination.",
  "schema": [
    {
      "name": "apple_ads",
      "physicalType": "file",
      "description": "Raw daily performance data from Apple Search Ads reports (campaign_report, keyword_report, search_term_report). One row per date + campaign/ad_group/keyword/search_term + breakdown combination.",
      "properties": [
        {
          "name": "date",
          "logicalType": "string",
          "logicalTypeOptions": { "format": "date", "pattern": "yyyy-MM-dd" },
          "description": "Report date",
          "quality": [
            { "metric": "nullValues", "mustBe": 0 }
          ]
        },
        {
          "name": "adamId",
          "logicalType": "string",
          "transformLogic": "metadata.app.adamId as adamId"
        },
        {
          "name": "appName",
          "logicalType": "string",
          "transformLogic": "metadata.app.appName as appName"
        },
        {
          "name": "countryOrRegion",
          "logicalType": "string",
          "transformLogic": "metadata.countryOrRegion as countryOrRegion"
        },
        {
          "name": "campaignId",
          "logicalType": "string",
          "transformLogic": "metadata.campaignId as campaignId",
          "quality": [
            { "metric": "nullValues", "mustBe": 0 }
          ]
        },
        {
          "name": "campaignName",
          "logicalType": "string",
          "transformLogic": "metadata.campaignName as campaignName"
        },
        {
          "name": "campaignStatus",
          "logicalType": "string",
          "transformLogic": "metadata.campaignStatus as campaignStatus"
        },
        {
          "name": "orgId",
          "logicalType": "string",
          "transformLogic": "metadata.orgId as orgId"
        },
        {
          "name": "impressions",
          "logicalType": "string",
          "logicalTypeOptions": { "format": "number" },
          "quality": [
            { "metric": "nullValues", "mustBe": 0 },
            { "type": "sql", "query": "SELECT COUNT(*) FROM {object} WHERE CAST({property} AS BIGINT) < 0", "mustBe": 0 }
          ]
        },
        {
          "name": "taps",
          "logicalType": "string",
          "logicalTypeOptions": { "format": "number" },
          "quality": [
            { "metric": "nullValues", "mustBe": 0 },
            { "type": "sql", "query": "SELECT COUNT(*) FROM {object} WHERE CAST({property} AS BIGINT) < 0", "mustBe": 0 }
          ]
        },
        {
          "name": "totalInstalls",
          "logicalType": "string",
          "logicalTypeOptions": { "format": "number" }
        },
        {
          "name": "totalNewDownloads",
          "logicalType": "string",
          "logicalTypeOptions": { "format": "number" }
        },
        {
          "name": "totalRedownloads",
          "logicalType": "string",
          "logicalTypeOptions": { "format": "number" }
        },
        {
          "name": "amount",
          "logicalType": "string",
          "logicalTypeOptions": { "format": "number" },
          "transformLogic": "localSpend.amount as amount",
          "quality": [
            { "metric": "nullValues", "mustBe": 0 },
            { "type": "sql", "query": "SELECT COUNT(*) FROM {object} WHERE CAST({property} AS DOUBLE) < 0", "mustBe": 0 },
            { "type": "sql", "query": "SELECT COUNT(*) FROM {object} WHERE CAST({property} AS DOUBLE) > 100000", "mustBe": 0, "severity": "warning" }
          ]
        },
        {
          "name": "currency",
          "logicalType": "string",
          "transformLogic": "localSpend.currency as currency"
        }
      ],
      "quality": [
        { "metric": "rowCount", "mustBeGreaterThan": 0 }
      ]
    }
  ],
  "slaProperties": [
    { "property": "frequency", "value": 1, "unit": "d" }
  ],
  "servers": [
    {
      "server": "minio",
      "type": "s3",
      "location": "s3a://lakehouse/apple_ads/{orgId}/{date}",
      "format": "json"
    }
  ],
  "customProperties": [
    {
      "name": "reference",
      "value": "https://developer.apple.com/documentation/apple_search_ads",
      "description": "Official Apple Search Ads API Reference"
    },
    {
      "name": "campaign_level_reports",
      "value": "https://developer.apple.com/documentation/apple_ads/get-campaign-level-reports",
      "description": "Get Campaign-Level Reports"
    }
  ]
}